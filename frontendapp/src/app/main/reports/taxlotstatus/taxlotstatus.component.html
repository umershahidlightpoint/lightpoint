<!-- Hide Grid Div -->
<div *ngIf="hideGrid" #logScroll [ngStyle]="processingMsgDiv">
  <div class="d-flex align-items-center justify-content-center">
    <h1> Posting Engine is Running. Please Wait. </h1>
  </div>
</div>
<!-- Hide Grid Div Ends -->

<!-- Loader -->
<div *ngIf="isLoading" class="loader-wrapper mtop-15">
  <lp-loading></lp-loading>
  <!-- Loader -->
</div>

<!-- Reports Main Div Starts -->
<div [hidden]="isLoading" [ngStyle]="{ 'display': hideGrid ? 'none' : 'initial' } ">
  <!-- Filters Div Starts -->
  <div class="row ">
    <!-- Funds Dropdown Div Starts -->
    <div class="col-auto">
      <select class="form-control" [(ngModel)]="fund" (ngModelChange)="changeFund($event)">
        <option selected>All Funds</option>
        <option *ngFor="let fund of funds" [ngValue]="fund.fundCode">
          {{ fund.fundCode }}
        </option>
      </select>
      <!-- Funds Dropdown Div Ends -->
    </div>

    <!-- Symbol filter -->
    <div class="col-auto">
      <input type="text" autocomplete="off" placeholder="Filter by Symbol" name="symbol" [(ngModel)]="filterBySymbol"
        (ngModelChange)="ngModelChangeSymbol($event)" (keyup)="onSymbolKey($event)" class="form-control" />
    </div>

    <!-- DateRange Label Div Starts -->
    <div class="font-weight-bold">
      <label class="text-right"> {{ DateRangeLabel }} </label>
    </div>
    <!-- DateRange Label Div Ends -->

    <!-- Date Picker Div Starts -->
    <div class="col-auto">
      <form>
        <input ngxDaterangepickerMd class="form-control" type="text" autocomplete="off" placeholder="Choose date"
          [(ngModel)]="selected" name="selectedDaterange" (ngModelChange)="changeDate($event)" [singleDatePicker]="true"
          [autoApply]="true" [maxDate]="maxDate" />
      </form>
    </div>
    <!-- Date Picker Div Ends -->

    <!-- Clear Button Div Starts -->
    <div class="col-auto">
      <button (click)="clearFilters()" class="btn btn-pa" tooltip="Clear" placement="top">
        <i class="fa fa-remove"></i>
      </button>
    </div>
    <!-- Clear Button Div Ends -->

    <!-- Buttons Div Starts -->
    <div class="ml-auto">
      <!-- Refresh Button Div Starts -->
      <div class="mr-2 d-inline-block">
        <button (click)="refreshReport()" class="btn btn-pa" tooltip="Refresh" placement="top">
          <i class="fa fa-refresh"></i></button>
      </div>
      <!-- Refresh Button Div Ends -->
      <!-- Export to Excel Button -->
      <div class="mr-2 d-inline-block">
        <button (click)="onBtExport()" class="btn btn-pa" tooltip="Export to Excel" placement="top">
          <i class="fa fa-arrow-circle-o-down"></i>
        </button>
      </div>
      <!-- Export to Excel Button Ends -->

      <!-- Expand/Collapse Button -->
      <div class="d-inline-block"
        [ngClass]="{'mr-2': taxLotStatusHorizontalConfig.closingTaxLotView, 'mr-3': !taxLotStatusHorizontalConfig.closingTaxLotView}">
        <ng-template #tooltipTemplate>{{taxLotStatusHorizontalConfig.closingTaxLotView ? 'Expand' : 'Collapse'}}
        </ng-template>
        <button
          (click)="taxLotStatusHorizontalConfig.closingTaxLotView = !taxLotStatusHorizontalConfig.closingTaxLotView"
          class="btn btn-pa" [tooltip]="tooltipTemplate" placement="top">
          <i class="fa"
            [ngClass]="{'fa-arrow-right': taxLotStatusHorizontalConfig.closingTaxLotView, 'fa-arrow-left': !taxLotStatusHorizontalConfig.closingTaxLotView}"></i>
        </button>
      </div>
      <!-- Expand/Collapse Button Ends -->

      <!-- Vertical Expand/Collapse Button -->
      <div *ngIf="taxLotStatusHorizontalConfig.closingTaxLotView" class="d-inline-block"
        [ngClass]="{'mr-3': taxLotStatusHorizontalConfig.closingTaxLotView, 'mr-2': !taxLotStatusHorizontalConfig.closingTaxLotView}">
        <ng-template #tooltipTemplate>{{taxLotStatusVerticalConfig.journalView ? 'Expand' : 'Collapse'}}</ng-template>
        <button (click)="taxLotStatusVerticalConfig.journalView = !taxLotStatusVerticalConfig.journalView"
          class="btn btn-pa" [tooltip]="tooltipTemplate" placement="top">
          <i class="fa"
            [ngClass]="{'fa-arrow-down': taxLotStatusVerticalConfig.journalView, 'fa-arrow-up': !taxLotStatusVerticalConfig.journalView}"></i>
        </button>
      </div>
      <!-- Vertical Expand/Collapse Button Ends -->

    </div>
    <!-- Buttons Div Ends -->

  </div>
  <!-- Filters Div Ends -->

  <!-- Report Grid Starts -->
  <div [ngStyle]="styleForHeight">

    <!-- Main Split Row Starts -->
    <div class="split-area row h-100">

      <!-- AS Split Main Container -->
      <as-split class="pl-15 pr-15" disabled="false" direction="horizontal"
        [useTransition]="taxLotStatusHorizontalConfig.useTransition" (dragEnd)="applyHorizontalPageLayout($event)"
        (transitionEnd)="applyHorizontalPageLayout($event)">

        <!-- Tax Lot Split Area -->
        <as-split-area [visible]="taxLotStatusHorizontalConfig.taxLotStatusView"
          [size]="taxLotStatusHorizontalConfig.taxLotStatusSize" order="1">
          <ag-grid-angular class="w-100 h-100 ag-theme-balham" (rowSelected)="onRowSelected($event)"
            [gridOptions]="gridOptions">
          </ag-grid-angular>
        </as-split-area>
        <!-- Tax Lot Split Area Ends -->

        <!-- Closing Tax Lot Split Area -->
        <as-split-area [visible]="taxLotStatusHorizontalConfig.closingTaxLotView"
          [size]="taxLotStatusHorizontalConfig.closingTaxLotSize" order="2">

          <!-- Closing Tax Lot Split Container -->
          <as-split disabled="false" direction="vertical" [useTransition]="taxLotStatusVerticalConfig.useTransition"
            (dragEnd)="applyVerticalPageLayout($event)" (transitionEnd)="applyVerticalPageLayout($event)">

            <!-- Closing Tax Lot Area -->
            <as-split-area [visible]=" taxLotStatusVerticalConfig.closingTaxLotView"
              [size]="taxLotStatusVerticalConfig.closingTaxLotSize" order="1">

              <ag-grid-angular class="w-100 h-100 ag-theme-balham" (rowSelected)="onTradeRowSelected($event)"
                [gridOptions]="closingTaxLots">
              </ag-grid-angular>

            </as-split-area>
            <!-- Closing Tax Lot Area Ends -->

            <!-- Journals Area -->
            <as-split-area [visible]="taxLotStatusVerticalConfig.journalView"
              [size]="taxLotStatusVerticalConfig.journalSize" order="2">

              <div class="w-100 height-90 p-0">
                <app-journals [subscription]="tradeSelectionChanged" [title]="'Journals'"></app-journals>
              </div>

            </as-split-area>
            <!-- Journals Area Ends -->

          </as-split>
          <!-- Closing Tax Lot Split Container Ends -->

        </as-split-area>
        <!-- Closing Tax Lot Split Area Ends -->

      </as-split>
      <!-- AS Split Main Container Ends -->

    </div>
    <!-- Main Split Row Ends -->

  </div>
  <!-- Report Grid Ends -->

</div>
<!-- Reports Main Div Ends-->

<!-- Data Modal -->
<app-data-modal #dataModal title="Trade Detail" [isCustomData]="true">
</app-data-modal>
<!-- Data Modal Ends -->

<!-- Data Grid Modal Starts -->
<app-data-grid-modal #dataGridModal gridTitle="Open Tax Lot Journals" [expanded]="true">
</app-data-grid-modal>
<!-- Data Grid Modal Ends -->

<app-create-dividend #dividendModal (modalClose)="closeDividendModal()"></app-create-dividend>

<app-create-stock-splits #stockSplitsModal (modalClose)="closeStockSplitModal()">
</app-create-stock-splits>

<app-create-security #securityModal (modalClose)="closeSecurityModal()"></app-create-security>